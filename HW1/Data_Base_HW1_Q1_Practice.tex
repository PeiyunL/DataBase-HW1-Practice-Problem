\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{geometry}
\usepackage{enumitem}
\usepackage{hyperref}

\geometry{margin=1in}

\title{Database Systems (CSCI 4380-01)\\
Homework 1 --- Practice Problems (Q1)\\}
\author{Peiyun Li}
\date{\today}

\begin{document}
\maketitle

\vspace*{-0.3in}

% =========================
% Overview / Context
% =========================
\section*{Overview}

This document contains \textbf{original practice problems} and
\textbf{fully worked, step-by-step solutions} for Homework~1,
Questions~1 and~2.  
It follows the same dataset, schema, relational algebra notation,
and formatting conventions as the original assignment.

\bigskip
\noindent
\textbf{Course Context.}  
Homework~1 focuses on relational algebra and normalization using
an airline database.

\bigskip
\noindent
\textbf{Database Description.}

The Airline Data Analysis database contains the following relations
(keys are underlined):

\begin{itemize}
\item {\tt Aircraft(\underline{Code}, Model, Range)}
\item {\tt Airports(\underline{Code}, Name, City, Latitude, Longitude, Timezone)}
\item {\tt Flights(\underline{FId}, FlightNumber, ScheduledDeparture, ScheduledArrival,\\
\hspace*{2.8em}DepartureAirportCode, ArrivalAirportCode, AircraftCode, ActualDeparture, ActualArrival)}
\item {\tt Tickets(\underline{TicketNo}, PassengerId)}
\item {\tt TicketFlights(\underline{TicketNo}, FId, FareConditions, Amount)}
\item {\tt Passengers(\underline{PassengerId}, FirstName, LastName, DOB)}
\end{itemize}

\bigskip
\noindent
\textbf{Date/Time Note.}  
Date comparisons use the homework format, e.g.
\texttt{ScheduledDeparture::date = date '02/01/2026'} and
\texttt{ActualDeparture <= now()}.

% =========================
% Practice Question 1
% =========================
\section*{Practice Problem for Homework 1 Question 1}

\subsection*{Problem Statement}
Use the same airline dataset and relations as Homework~1.

\begin{enumerate}[label=(\alph*)]
\item Return the \textbf{airport code and city} of all airports located
in the timezone \texttt{"Europe/London"}.

\item Return the \textbf{FlightNumber} of all flights that are scheduled to
\textbf{depart today} but have \textbf{not yet departed}.

\item Return the \textbf{first and last names} of passengers who have flown
on \textbf{at least one flight} but have \textbf{never flown in Economy class}.
\end{enumerate}

% -------------------------
% Solution (a)
% -------------------------
\subsection*{Solution (a): Airports in Europe/London}

\textbf{Step 1.} Timezone and city are stored in the \texttt{Airports} relation.

\textbf{Step 2.} Select airports whose timezone is \texttt{"Europe/London"}.

\textbf{Step 3.} Project the requested attributes (\texttt{Code} and \texttt{City}).

\medskip
\noindent
\textbf{Relational Algebra:}
\[
\boxed{
\begin{array}{l}
\texttt{project\_(Code, City)}\\
\texttt{\quad select\_\{Timezone = "Europe/London"\}(Airports)}
\end{array}
}
\]

\paragraph{Semantics:}
Returns the codes and cities of airports located in the Europe/London timezone.

% -------------------------
% Solution (b)
% -------------------------
\subsection*{Solution (b): Scheduled today but not yet departed}

Assume today is \texttt{date '02/01/2026'}.

\textbf{Step 1.} Select flights scheduled to depart today.

\textbf{Step 2.} Identify flights that have already departed
(\texttt{ActualDeparture <= now()}).

\textbf{Step 3.} Subtract departed flights from all flights scheduled today.

\textbf{Step 4.} Project the \texttt{FlightNumber}.

\medskip
\noindent
\textbf{Relational Algebra:}
\[
\boxed{
\begin{array}{l}
\texttt{Today(FId, FlightNumber) = project\_(FId, FlightNumber)}\\
\texttt{\quad select\_\{ScheduledDeparture::date = date '02/01/2026'\}(Flights)}\\[6pt]

\texttt{Departed(FId, FlightNumber) = project\_(FId, FlightNumber)}\\
\texttt{\quad select\_\{ScheduledDeparture::date = date '02/01/2026' \; AND}\\
\texttt{\quad\quad ActualDeparture <= now()\}(Flights)}\\[6pt]

\texttt{project\_(FlightNumber)(Today - Departed)}
\end{array}
}
\]

\paragraph{Semantics:}
Returns flight numbers of flights scheduled to depart today that have not yet departed.

% -------------------------
% Solution (c)
% -------------------------
\subsection*{Solution (c): Flew at least once, but never Economy}

\textbf{Step 1.} Passengers who have flown appear in \texttt{Tickets * TicketFlights}.

\textbf{Step 2.} Project \texttt{PassengerId} to obtain all passengers who have flown.

\textbf{Step 3.} Identify passengers who have ever flown Economy.

\textbf{Step 4.} Subtract Economy flyers from all flyers.

\textbf{Step 5.} Join with \texttt{Passengers} to retrieve names.

\medskip
\noindent
\textbf{Relational Algebra:}
\[
\boxed{
\begin{array}{l}
\texttt{Flew(PassengerId) = project\_(PassengerId)(Tickets * TicketFlights)}\\[6pt]

\texttt{Economy(PassengerId) = project\_(PassengerId)}\\
\texttt{\quad (select\_\{FareConditions = "Economy"\}(TicketFlights) * Tickets)}\\[6pt]

\texttt{project\_(FirstName, LastName)((Flew - Economy) * Passengers)}
\end{array}
}
\]

\paragraph{Semantics:}
Returns passengers who have taken at least one flight but never in Economy class.

\end{document}
